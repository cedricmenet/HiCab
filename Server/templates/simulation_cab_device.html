<!DOCTYPE HTML>
<html>
<head>
    <title>HiCab cab_device simulation</title>
    <script type="text/javascript" src="/scripts/jquery-1.4.2.min.js"></script>
    <script type="text/javascript" charset="utf-8">
        $(document).ready(function(){
            // Connection
            var socket = new WebSocket("ws://" + location.host + "/cab_device");
            socket.onopen = function() {
                message = {'id_cab': 0};
                socket.send(JSON.stringify(message));
            };
            socket.onclose = function(evt) {
                alert("socket closed");
            };
            socket.onmessage = function(evt){
                $('#log').append(evt.data + '<br/>');
            }
        
            // Envoi message
			$('form#send').submit(function(event) {
                socket.send($('#send_data').val());
                return false;
            });
            // Deconnection
			$('form#disconnect').submit(function(event) {
                socket.close();
                return false;
            });
        });
    </script>
</head>
<body>
    <h1>HiCab cab_device simulation</h1>
    <h2>Send:</h2>
    <form id="connect" method="POST" action="">
        <input type="submit" value="Connect">
    </form>
    <form id="send" method="POST" action="">
        <input type="text" name="send" id="send_data" placeholder="Message">
        <input type="submit" value="Send">
    </form>
    <form id="disconnect" method="POST" action="">
        <input type="submit" value="Disconnect">
    </form>
	
    <h2>Receive:</h2>
    <div id="log"></div>
</body>
</html>